function filter_JDX_data(t){molecule_ir_data=new Array;for(var e=t.split("\n"),a=0;a<e.length-1;a++)if(void 0!==typeof e[a]&&""!==e[a]){var n=e[a].charAt(0);if(n%1==0){var r=e[a].split(" ");molecule_ir_data.push({frequency:r[0],value:r[1]})}else{var c=document.getElementById("data-comments"),l=document.createElement("p");l.innerHTML="#"==n?e[a].substring(2):e[a],c.appendChild(l)}}chart_this(molecule_ir_data)}function setup(){canvas=createCanvas(container.offsetWidth,800),canvas.parent(container_name)}function draw(){background(0),molecule_ir_data.forEach(function(t){console.log(t.value)})}function chart_this(t){var e=Array.prototype.slice.call(t),a=document.getElementById("canvas-wrapper");e.forEach(function(t){t.frequency=t.frequency,t.value=t.value});var n={top:20,right:30,bottom:30,left:40},r=a.offsetWidth-n.left-n.right,c=a.offsetHeight-n.top-n.bottom,l=d3.scaleLinear().range([0,r]),o=d3.scaleLinear().range([c,0]),s=d3.line().x(function(t){return l(t.frequency)}).y(function(t){return o(t.value)}),d=d3.select("body #canvas-wrapper").append("svg").attr("class","line-chart").datum(e).attr("width",r+n.left+n.right).attr("height",c+n.top+n.bottom).append("g").attr("transform","translate("+n.left+","+n.top+")");l.domain([e[0].frequency,e[e.length-1].frequency]),o.domain([0,d3.max(e,function(t){return t.value})]),d.append("path").data([e]).attr("class","line").attr("d",s),d.append("g").attr("transform","translate(0,"+c+")").call(d3.axisBottom(l)).attr("class","axisWhite").append("text").attr("transform","translate("+(r-60)+", -10)").attr("class","legend").text("Wavelength"),d.append("g").call(d3.axisLeft(o)).attr("class","axisWhite").append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").attr("class","legend").text("Transmitance")}var molecule_ir_data=new Array,molecule_select=document.getElementById("molecule-select");get_JDX_data=function(t,e,a){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e&&e(n.responseText):a&&a(n))},n.open("GET",t,!0),n.send()},molecule_select.onchange=function(){var t=void 0===this.selectedIndex?window.event.srcElement:this,e=t.value||t.options[t.selectedIndex].value;document.getElementById("canvas-wrapper").innerHTML="",document.getElementById("data-comments").innerHTML="",get_JDX_data(e,filter_JDX_data)},get_JDX_data("_jcamp/111-65-9-IR.jdx",filter_JDX_data);var container_name="canvas-wrapper",container=document.getElementById(container_name),canvas;